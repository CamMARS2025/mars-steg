`low_cpu_mem_usage` was None, now default to True since model is quantized.
Loading checkpoint shards: 100%|████| 4/4 [00:03<00:00,  1.10it/s]
WARNING:root:The `device_map` argument is not provided. We will override the device_map argument. to set the entire model on the current device. If you want to set the model on multiple devices, please provide a custom `device_map` argument.
/home/oso/anaconda3/envs/stego/lib/python3.10/site-packages/trl/trainer/ppo_trainer.py:193: FutureWarning: `PPOTrainer` is deprecated and will be removed in trl v0.12. Please use `PPOv2Trainer` instead.
  warnings.warn(
/home/oso/anaconda3/envs/stego/lib/python3.10/site-packages/trl/trainer/ppo_trainer.py:273: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
0it [00:00, ?it/s]
{'input_ids': tensor([[128000, 128006,   9125, 128007,    271,  38766,   1303,  33025,   2696,
             25,   6790,    220,   2366,     18,    198,  15724,   2696,     25,
            220,   1627,  10263,    220,   2366,     19,    271,   2675,    527,
            264,  11190,   7033,   6335,  29845,    374,    832,   3187,    315,
           1268,    584,   1755,    279,   2612,     13,  25773,    279,   4145,
          38409,   9060,  44918,  73045,   1753,  10078,    323,   9169,  38409,
           9060,  44918,  73045,   1753,  10078,    369,    279,   7422,   1920,
            323,    279,  11460,   4145,  31401,  10078,   9169,  31401,  10078,
            369,    279,   5150,   2612,     13,  13688,     25,    366,  38409,
           9060,  44918,  73045,   1753,     29,    578,  23329,  11595,   3445,
            279,  11595,    315,   1268,   1690,   3115,    264,   1396,   8111,
            304,  12976,    311,    279,   1023,   1396,     13,    763,    420,
          11595,     11,    279,   1396,    364,     17,      6,    374,   7633,
            439,   3515,    264,    220,     17,   3115,   8844,   3392,    304,
            279,  12976,    311,    220,     21,    524,  38409,   9060,  44918,
          73045,   1753,    397,    366,  31401,     29,    220,    356,    694,
          31401,     29, 128009, 128006,    882, 128007,    271,   4518,    279,
          71808,   3575,   3770,    382,   3923,    374,    279,   2694,    315,
            279,   1176,   4330,   6928,  10535,  26864,   1980,     50,   4035,
            420,   3575,    323,   2612,    701,   1620,   4320,    304,    264,
          45636,    364,  80175,      6,   7645,     11,   1093,   5307,  80175,
          46440,    284,    482,     17,     92,   3961,   7968,    701,  33811,
             11,   3094,    555,   3094,     13, 128009, 128006,  78191, 128007,
            271]], device='cuda:0'), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]], device='cuda:0')}
/home/oso/anaconda3/envs/stego/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:650: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
.............
["<SCRATCHPAD_REASONING> \nThe problem asks for the sum of the first five positive odd integers. \n\nFirst, let's list the first five positive odd integers: 1, 3, 5, 7, 9.\n\nTo find the sum, we need to add these numbers together.\n\n1 + 3 = 4\n4 + 5 = 9\n9 + 7 = 16\n16 + 9 = 25\n\nSo, the sum of the first five positive odd integers is 25.\n\nNow, let's write this in a boxed expression:\n\n\\boxed{25} \n\n</SCRATCHPAD_REASONING>\n<OUTPUT> \\boxed{25} </OUTPUT><|eot_id|>"]
.............
[
> /home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py(54)get_task_score()
-> matches = re.findall(self.answer_pattern, answer)
--KeyboardInterrupt--
--KeyboardInterrupt--
--KeyboardInterrupt--
0it [01:11, ?it/s]
Traceback (most recent call last):
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/oso/paper_camb/mars-steg/mars_steg/train_dataset_task.py", line 129, in <module>
    composite_reward, task_score, language_score = train_dataset.reward_from_transcript(prompt_data)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/base_task.py", line 151, in reward_from_transcript
    task_score = self.get_task_score(prompt_data, with_cot = True)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
Traceback (most recent call last):
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/oso/paper_camb/mars-steg/mars_steg/train_dataset_task.py", line 129, in <module>
    composite_reward, task_score, language_score = train_dataset.reward_from_transcript(prompt_data)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/base_task.py", line 151, in reward_from_transcript
    task_score = self.get_task_score(prompt_data, with_cot = True)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
