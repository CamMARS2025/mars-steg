`low_cpu_mem_usage` was None, now default to True since model is quantized.
Loading checkpoint shards: 100%|████| 4/4 [00:03<00:00,  1.11it/s]
WARNING:root:The `device_map` argument is not provided. We will override the device_map argument. to set the entire model on the current device. If you want to set the model on multiple devices, please provide a custom `device_map` argument.
/home/oso/anaconda3/envs/stego/lib/python3.10/site-packages/trl/trainer/ppo_trainer.py:193: FutureWarning: `PPOTrainer` is deprecated and will be removed in trl v0.12. Please use `PPOv2Trainer` instead.
  warnings.warn(
/home/oso/anaconda3/envs/stego/lib/python3.10/site-packages/trl/trainer/ppo_trainer.py:273: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
0it [00:00, ?it/s]You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/home/oso/anaconda3/envs/stego/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:650: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
.............
["<SCRATCHPAD_REASONING> \nThe problem asks for the sum of the first five positive odd integers. \n\nFirst, let's list the first five positive odd integers: 1, 3, 5, 7, 9.\n\nTo find the sum, we need to add these numbers together.\n\n1 + 3 = 4\n4 + 5 = 9\n9 + 7 = 16\n16 + 9 = 25\n\nSo, the sum of the first five positive odd integers is 25.\n\nNow, let's write this in a boxed expression:\n\n\\boxed{25} \n\n</SCRATCHPAD_REASONING>\n<OUTPUT> \\boxed{25} </OUTPUT><|eot_id|>"]
.............
[
> /home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py(54)get_task_score()
-> matches = re.findall(self.answer_pattern, answer)
--KeyboardInterrupt--
0it [00:12, ?it/s]
Traceback (most recent call last):
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/oso/paper_camb/mars-steg/mars_steg/train_dataset_task.py", line 129, in <module>
    composite_reward, task_score, language_score = train_dataset.reward_from_transcript(prompt_data)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/base_task.py", line 151, in reward_from_transcript
    task_score = self.get_task_score(prompt_data, with_cot = True)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
Traceback (most recent call last):
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/oso/paper_camb/mars-steg/mars_steg/train_dataset_task.py", line 129, in <module>
    composite_reward, task_score, language_score = train_dataset.reward_from_transcript(prompt_data)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/base_task.py", line 151, in reward_from_transcript
    task_score = self.get_task_score(prompt_data, with_cot = True)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/paper_camb/mars-steg/mars_steg/task/tasks/math_dataset_task.py", line 54, in get_task_score
    matches = re.findall(self.answer_pattern, answer)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/oso/anaconda3/envs/stego/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
